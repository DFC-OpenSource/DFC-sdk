From: Mark Andrews <marka@isc.org>
Date: Tue, 14 Jul 2015 04:48:42 +0000 (+1000)
Subject: 4165.   [bug]           An failure to reset a value to NULL in tkey.c could
X-Git-Url: https://source.isc.org/cgi-bin/gitweb.cgi?p=bind9.git;a=commitdiff_plain;h=dbb064aa7972ef918d9a235b713108a4846cbb62;hp=faa3b61828dc2c6b92b68cd6e603fe2b9a7d5fdc

4165.   [bug]           An failure to reset a value to NULL in tkey.c could
                        result in an assertion failure. (CVE-2015-5477)
                        [RT #40046]

Upstream-Status: Backport
---

Index: bind-9.9.5/lib/dns/tkey.c
===================================================================
--- bind-9.9.5.orig/lib/dns/tkey.c
+++ bind-9.9.5/lib/dns/tkey.c
@@ -650,6 +650,7 @@ dns_tkey_processquery(dns_message_t *msg
 		 * Try the answer section, since that's where Win2000
 		 * puts it.
 		 */
+		name = NULL;
 		if (dns_message_findname(msg, DNS_SECTION_ANSWER, qname,
 					 dns_rdatatype_tkey, 0, &name,
 					 &tkeyset) != ISC_R_SUCCESS) {
