Upstream-Status: Backport

CVE-2014-8503 fix.

[YOCTO #7084]

Signed-off-by: Armin Kuster <akuster808@gmail.com>

From 0102ea8cec5fc509bba6c91df61b7ce23a799d32 Mon Sep 17 00:00:00 2001
From: Nick Clifton <nickc@redhat.com>
Date: Thu, 30 Oct 2014 17:16:17 +0000
Subject: [PATCH] Fixes a seg-fault in the ihex parser when it encounters a
 malformed ihex file.

	PR binutils/17512
	* ihex.c (ihex_scan): Fix typo in invocation of ihex_bad_byte.
---
 bfd/ChangeLog | 1 +
 bfd/ihex.c    | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

Index: binutils-2.24/bfd/ihex.c
===================================================================
--- binutils-2.24.orig/bfd/ihex.c
+++ binutils-2.24/bfd/ihex.c
@@ -322,7 +322,7 @@ ihex_scan (bfd *abfd)
 	    {
 	      if (! ISHEX (buf[i]))
 		{
-		  ihex_bad_byte (abfd, lineno, hdr[i], error);
+		  ihex_bad_byte (abfd, lineno, buf[i], error);
 		  goto error_return;
 		}
 	    }
Index: binutils-2.24/bfd/ChangeLog
===================================================================
--- binutils-2.24.orig/bfd/ChangeLog
+++ binutils-2.24/bfd/ChangeLog
@@ -1,3 +1,8 @@
+2014-10-30  Nick Clifton  <nickc@redhat.com>
+
+    PR binutils/17512
+    * ihex.c (ihex_scan): Fix typo in invocation of ihex_bad_byte.
+
 2014-10-27  Nick Clifton  <nickc@redhat.com>
 
        PR binutils/17512
